<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Cambiar Contraseña</title>
  <link rel="stylesheet" href="/css/auth.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
</head>
<body class="auth-page">
  <div class="auth-container">
    <div class="auth-card">
      <div class="auth-header">
        <h2>Cambiar Contraseña</h2>
      </div>
      
      <div class="auth-body">
        <% if (errors && errors.length > 0) { %>
          <div class="auth-error">
            <% errors.forEach(error => { %>
              <p><%= error %></p>
            <% }); %>
          </div>
        <% } %>
        
        <form class="auth-form" action="/auth/change-password" method="POST">
          <!-- Datos del usuario (solo lectura) -->
          <div class="form-group">
            <label>Nombre</label>
            <input type="text" value="<%= user.name %>" readonly>
          </div>
          
          <div class="form-group">
            <label>Cédula</label>
            <input type="text" value="<%= user.cedula %>" readonly>
          </div>
          
          <div class="form-group">
            <label>Teléfono</label>
            <input type="text" name="telefono" value="<%= user.telefono %>">
          </div>
          
          <div class="form-group">
            <label>Email</label>
            <input type="email" name="email" value="<%= user.email %>">
          </div>
          
          <div class="form-group">
            <label>Nombre de usuario</label>
            <input type="text" value="<%= user.username %>" readonly>
          </div>
          
          <div class="form-group">
            <label>Rol</label>
            <input type="text" value="<%= user.role %>" readonly>
          </div>
          
          <!-- Campos para cambiar contraseña 
          <div class="form-group">
            <label>Contraseña actual</label>
            <div style="position: relative;">
              <input type="password" id="currentPassword" name="currentPassword">
              <i class="fas fa-eye" style="position: absolute; right: 10px; top: 12px; cursor: pointer;" 
                 onclick="togglePassword('currentPassword')"></i>
            </div>
          </div>-->
          
          <div class="form-group">
            <label>Nueva contraseña</label>
            <div style="position: relative;">
            <input type="password" id="newPassword" name="newPassword" required>
            <i class="fas fa-eye" style="position: absolute; right: 10px; top: 12px; cursor: pointer;" 
                 onclick="togglePassword('newPassword')"></i>
            </div>
          </div>
          <div class="form-group">
            <label>Repetir nueva contraseña</label>
            <div style="position: relative;">
            <input type="password" id="repeatPassword" name="repeatPassword" required>
            <i class="fas fa-eye" style="position: absolute; right: 10px; top: 12px; cursor: pointer;" 
                 onclick="togglePassword('repeatPassword')"></i>
            </div>
          </div>
          
          <button type="submit" class="auth-button">Guardar Cambios</button>
        </form>
      </div>
      
      <div class="auth-footer">
        <a href="/dashboard">Volver al dashboard</a>
      </div>
    </div>
  </div>

  <script>
    function togglePassword(inputId) {
      const input = document.getElementById(inputId);
      const icon = input.nextElementSibling;
      
      if (input.type === "password") {
        input.type = "text";
        icon.classList.replace("fa-eye", "fa-eye-slash");
      } else {
        input.type = "password";
        icon.classList.replace("fa-eye-slash", "fa-eye");
      }
    }
  </script>
</body>
</html>